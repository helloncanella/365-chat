(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{108:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(48),o=n.n(c),i=(n(66),n(13)),s=n(14),l=n(16),m=n(15),u=n(17),d=n(114),f=n(52),p=n(110),v=n(30),g=n.n(v),h=n(43),b=n(26),E=n(6),j=(n(70),function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).onSubmit=function(e){e.preventDefault(),n.input.value&&n.props.registerUser({name:n.input.value})},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"registration"},r.a.createElement("div",{className:"registration-card"},r.a.createElement("div",{className:"logo"},"365"),r.a.createElement("div",{className:"content"},r.a.createElement("h2",null,"Your name"),r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{type:"text",ref:function(t){return e.input=t}}),r.a.createElement("button",{type:"submit",disabled:this.props.isRegistering},this.props.isRegistering?"loading...":"register")))))}}]),t}(a.Component)),O=n(112),y=n(21),N=n(28),w=n.n(N),k=n(20),x=n.n(k);function I(){var e=Object(b.a)(["\n  mutation CreateUser($name: String!, $color: String!) {\n    createUser(name: $name, color: $color) {\n      _id\n    }\n  }\n"]);return I=function(){return e},e}var S=w()(I()),C=function(){var e=["purple","blue","red","orange","green","indigo"];return e[x.a.random(0,e.length-1)]},M=Object(E.a)(O.a,Object(E.f)("isRegistering","setLoadingState",!1),Object(y.b)(S,{props:function(e){var t=e.mutate;return{createUser:function(){var e=Object(h.a)(g.a.mark(function e(){var n,a,r,c=arguments;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>0&&void 0!==c[0]?c[0]:{},a=n.name,e.next=3,t({variables:{name:a,color:C()}});case 3:return r=e.sent,e.abrupt("return",x.a.get(r,"data.createUser"));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}}}),Object(E.d)({registerUser:function(e){return function(){var t=Object(h.a)(g.a.mark(function t(n){var a,r;return g.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.name){t.next=3;break}return t.abrupt("return");case 3:return e.setLoadingState(!0),t.next=6,e.createUser({name:a});case 6:r=t.sent,localStorage.setItem("loggedUserId",r._id),e.setLoadingState(!1),e.history.push("/");case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}))(j);n(78);function D(e){var t=e.icon,n=e.className,a=e.style;return r.a.createElement("div",{className:"fa fa-".concat(t," ").concat(n||""),style:a||{}})}var U=n(59),_=(n(79),n(113));function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.icon,a=void 0===n?null:n,c=e.rightComponent,o=void 0===c?null:c,i=e.className,s=e.path,l=e.style;return r.a.createElement(_.a,{className:"menu-item ".concat(i||""),activeClassName:"selected",style:Object(U.a)({},l||{}),to:s},r.a.createElement("div",{className:"content"},a&&r.a.createElement("div",{className:"icon-container"},a),r.a.createElement("div",{className:"name"},t)),o)}n(80);var Y=n(53),$=[{name:"Simple room",color:"orange",id:"single-room",isOnline:!0}];Object(E.a)(O.a,Object(E.e)(function(e){var t,n=e.match;if(n)return{receivers:[(t=n.params.id,$.find(function(e){return e.id===t}))]}})),n(96);var q=Object(E.a)(E.c)(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).receiver||{};return e.name,e.isOnline,r.a.createElement("div",{className:"header"},r.a.createElement("h3",{className:"user-name"},"Simple room"))}),z=Object(E.a)(Object(E.e)(function(e){return{receiver:$.find(function(t){return t.id===e.roomId})}}))(q),L=n(56),T=n(54),A=n.n(T);var B=Object(E.a)(E.c)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.avatar,a=e.text,c=e.date;return r.a.createElement("div",{className:"message"},n&&r.a.createElement("div",{className:"avatar-column"},n),r.a.createElement("div",{className:"message-column"},r.a.createElement("div",{className:"meta-header"},r.a.createElement("span",{className:"name"},t)," ",r.a.createElement("span",{className:"date"},A()(c).format("DD/MM/YYYY"))),r.a.createElement("div",{className:"message-body"},a.split("\n").map(function(e,t){return r.a.createElement("p",{key:"message-timestamp-".concat(new Date(c).getTime(),"-").concat(t)},e)}))))});var J=Object(E.a)(E.c)(function(e){return r.a.createElement("ul",{className:"all-messages messages"},(e.messages||[]).map(function(e,t){return r.a.createElement("li",{className:"message-container",key:"message-".concat(t)},r.a.createElement(B,e))}))});function P(){var e=Object(b.a)(["\n  subscription NewMessage {\n    newMessage {\n      _id\n      content\n      timestamp\n      author {\n        _id\n        name\n        color\n      }\n    }\n  }\n"]);return P=function(){return e},e}function W(){var e=Object(b.a)(["\n  query AllMessages {\n    messages {\n      _id\n      content\n      author {\n        _id\n        name\n        color\n      }\n      timestamp\n    }\n  }\n"]);return W=function(){return e},e}var F=w()(W()),G=w()(P()),H=Object(E.a)(Object(y.b)(F),Object(E.b)(function(e){var t=e.data||{},n=t.loading,a=t.messages;return{messages:(void 0===a?[]:a).map(Q).sort(K),loading:n}}),Object(y.b)(G,{name:"subscription"}),Object(E.e)(function(e){var t=e.subscription,n=(e.loading,e.messages),a=(t||{}).newMessage;return{messages:a?[].concat(Object(L.a)(n),[Q(a)]).sort(K):n}}))(J),K=function(e,t){return new Date(e.date).getTime()-new Date(t.date).getTime()};function Q(e){var t=function(t){return x.a.get(e,t)};return{name:t("author.name"),date:new Date(t("timestamp")),text:t("content"),avatar:r.a.createElement("div",{style:{display:"flex",borderRadius:"50%",width:50,height:50,alignItems:"center",justifyContent:"center",background:t("author.color")}})}}var V=Object(E.a)(Object(E.b)(function(e){return{receiver:$.find(function(t){var n=t.id;return e.roomId===n})}}))(function(e){return e.receiver,r.a.createElement("div",{className:"footer"},r.a.createElement("div",{className:"input-container"},r.a.createElement("input",{type:"text",placeholder:"Message"})))}),X=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"chat"},r.a.createElement(z,{roomId:this.roomId}),this.body,r.a.createElement(V,{roomId:this.roomId}))}},{key:"body",get:function(){return r.a.createElement(Y.Scrollbars,{className:"body"},r.a.createElement("div",{className:"body-content"},r.a.createElement(H,{roomId:this.roomId})))}},{key:"roomId",get:function(){return x.a.get(this.props,"match.params.roomId")}}]),t}(a.Component);function Z(e){var t=e.children;return r.a.createElement("div",{className:"screen-centered",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"}},t)}var ee=[{path:"/chat-list",exact:!0,icon:"comment",name:"Chat",render:function(){return r.a.createElement(Z,null,r.a.createElement("h1",{style:{color:"gray",fontSize:"5rem"}},"Chat list"))}},{path:"/partner",icon:"users",name:"Partner",render:function(){return r.a.createElement(Z,null,r.a.createElement("h1",{style:{color:"gray",fontSize:"5rem"}},"Partner"))}},{path:"/document",icon:"file-text",name:"Document",render:function(){return r.a.createElement(Z,null,r.a.createElement("h1",{style:{color:"gray",fontSize:"5rem"}},"Document"))}},{from:"/",redirect:"/chat-list",exact:!0}],te=n(38),ne=Object(E.a)(Object(E.e)(function(e){return{contacts:$}}));function ae(){return r.a.createElement(Z,null,r.a.createElement("h1",{style:{color:"gray",fontSize:"5rem"}},"404"))}var re=Object(E.a)(O.a,ne)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.contacts,n=void 0===t?[]:t,a=e.match;return r.a.createElement("main",null,r.a.createElement(d.a,null,ee.map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.component,n=e.render,c=e.path,o=e.redirect,i=e.exact,s=e.from,l=arguments.length>1?arguments[1]:void 0,m={exact:i,key:"section-route-".concat(l)};return o?r.a.createElement(p.a,Object.assign({},m,{from:s,to:o})):c?r.a.createElement(f.a,Object.assign({},m,{render:n,component:t,path:Object(te.join)(a.url,c),key:"section-menu-item-".concat(l)})):null}),r.a.createElement(f.a,{path:"/chat/:roomId(".concat(n.map(function(e){return e.id}).join("|"),")"),component:X}),r.a.createElement(f.a,{component:ae})))}),ce=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"home"},r.a.createElement("div",{className:"first-menu"},r.a.createElement("img",{src:"/images/365-logo.png",alt:"logo"})),r.a.createElement("div",{className:"wrap"},r.a.createElement("div",{className:"notifications"}),this.secondMenu,r.a.createElement(re,null)))}},{key:"sectionsMenu",get:function(){return r.a.createElement("ul",{className:"sections-menu"},ee.filter(function(e){return!e.redirect}).map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.path,n=e.icon,a=e.name,c=arguments.length>1?arguments[1]:void 0;return r.a.createElement("li",{key:"section-menu-item-".concat(c)},r.a.createElement(R,{path:t,name:a,selected:!1,icon:r.a.createElement(D,{className:"icon",icon:n})}))}))}},{key:"favoriteContacts",get:function(){return r.a.createElement("div",{className:"favorite-contacts"},r.a.createElement("h5",{className:"title"},"Favorite Contacts"),r.a.createElement("ul",{className:"contacts"},$.map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.link,e.icon,e.name),n=e.color,a=e.id,c=(e.isOnline,arguments.length>1?arguments[1]:void 0);return r.a.createElement("li",{key:"contact-".concat(c)},r.a.createElement(R,{name:t,path:Object(te.join)("/chat",a),icon:r.a.createElement("div",{style:{width:30,height:30,background:n,borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"}})}))})))}},{key:"secondMenu",get:function(){return r.a.createElement("div",{className:"second-menu"},this.sectionsMenu,this.favoriteContacts)}}]),t}(a.Component),oe=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app"},r.a.createElement(d.a,null,r.a.createElement(f.a,{component:M,path:"/registration",exact:!0}),r.a.createElement(f.a,{path:"/",render:function(){return localStorage.getItem("loggedUserId")?r.a.createElement(ce,null):r.a.createElement(p.a,{to:"/registration"})}})))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ie=n(111),se=n(23),le=n(58),me=n(7),ue=n(57),de=n(55),fe=n(3),pe="chat-365.herokuapp.com",ve=new de.a({uri:"ws://".concat(pe,"/graphql"),options:{reconnect:!0}}),ge=new ue.a({uri:"http://".concat(pe,"/graphql")}),he=Object(me.d)(function(e){var t=e.query,n=Object(fe.k)(t),a=n.kind,r=n.operation;return"OperationDefinition"===a&&"subscription"===r},ve,ge);o.a.render(r.a.createElement(y.a,{client:new se.a({link:he,cache:new le.a})},r.a.createElement(ie.a,null,r.a.createElement(f.a,{component:oe}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},61:function(e,t,n){e.exports=n(108)},66:function(e,t,n){},70:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},96:function(e,t,n){}},[[61,1,2]]]);
//# sourceMappingURL=main.20e50276.chunk.js.map