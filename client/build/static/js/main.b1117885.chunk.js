(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,n){},116:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(53),o=n.n(c),i=(n(73),n(16)),s=n(17),l=n(19),u=n(18),m=n(20),d=n(121),p=n(57),f=n(118),g=n(23),v=n.n(g),h=n(32),b=n(24),E=n(6),j=(n(77),function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onSubmit=function(e){e.preventDefault(),n.input.value&&n.props.registerUser({name:n.input.value})},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"registration"},r.a.createElement("div",{className:"registration-card"},r.a.createElement("div",{className:"logo"},"365"),r.a.createElement("div",{className:"content"},r.a.createElement("h2",null,"Your name"),r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{type:"text",ref:function(t){return e.input=t}}),r.a.createElement("button",{type:"submit",disabled:this.props.isRegistering},this.props.isRegistering?"loading...":"register")))))}}]),t}(a.Component)),O=n(122),y=n(21),N=n(26),w=n.n(N),k=n(27),I=n.n(k);function S(){var e=Object(b.a)(["\n  mutation CreateUser($name: String!, $color: String!) {\n    createUser(name: $name, color: $color) {\n      _id\n    }\n  }\n"]);return S=function(){return e},e}var x=w()(S()),C=function(){var e=["purple","blue","red","orange","green","indigo"];return e[I.a.random(0,e.length-1)]},M=Object(E.a)(O.a,Object(E.f)("isRegistering","setLoadingState",!1),Object(y.b)(x,{props:function(e){var t=e.mutate;return{createUser:function(){var e=Object(h.a)(v.a.mark(function e(){var n,a,r,c=arguments;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>0&&void 0!==c[0]?c[0]:{},a=n.name,e.next=3,t({variables:{name:a,color:C()}});case 3:return r=e.sent,e.abrupt("return",I.a.get(r,"data.createUser"));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}}}),Object(E.d)({registerUser:function(e){return function(){var t=Object(h.a)(v.a.mark(function t(n){var a,r;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.name){t.next=3;break}return t.abrupt("return");case 3:return e.setLoadingState(!0),t.next=6,e.createUser({name:a});case 6:r=t.sent,localStorage.setItem("loggedUserId",r._id),e.setLoadingState(!1),e.history.push("/");case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}))(j);n(85);function D(e){var t=e.icon,n=e.className,a=e.style;return r.a.createElement("div",{className:"fa fa-".concat(t," ").concat(n||""),style:a||{}})}var U=n(45),$=(n(86),n(120));function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.icon,a=void 0===n?null:n,c=e.rightComponent,o=void 0===c?null:c,i=e.className,s=e.path,l=e.style;return r.a.createElement($.a,{className:"menu-item ".concat(i||""),activeClassName:"selected",style:Object(U.a)({},l||{}),to:s},r.a.createElement("div",{className:"content"},a&&r.a.createElement("div",{className:"icon-container"},a),r.a.createElement("div",{className:"name"},t)),o)}n(87);var q=n(58),z=[{name:"Simple room",color:"orange",id:"single-room",isOnline:!0}];Object(E.a)(O.a,Object(E.e)(function(e){var t,n=e.match;if(n)return{receivers:[(t=n.params.id,z.find(function(e){return e.id===t}))]}})),n(103);var R=Object(E.a)(E.c)(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).receiver||{};return e.name,e.isOnline,r.a.createElement("div",{className:"header"},r.a.createElement("h3",{className:"user-name"},"Simple room"))}),Y=Object(E.a)(Object(E.e)(function(e){return{receiver:z.find(function(t){return t.id===e.roomId})}}))(R),T=n(64),A=n(59),B=n.n(A);var L=Object(E.a)(E.c)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.avatar,a=e.text,c=e.date;return r.a.createElement("div",{className:"message"},n&&r.a.createElement("div",{className:"avatar-column"},n),r.a.createElement("div",{className:"message-column"},r.a.createElement("div",{className:"meta-header"},r.a.createElement("span",{className:"name"},t)," ",r.a.createElement("span",{className:"date"},B()(c).format("DD/MM/YYYY"))),r.a.createElement("div",{className:"message-body"},a.split("\n").map(function(e,t){return r.a.createElement("p",{key:"message-timestamp-".concat(new Date(c).getTime(),"-").concat(t)},e)}))))});var F=Object(E.a)(E.c)(function(e){return r.a.createElement("ul",{className:"all-messages messages"},(e.messages||[]).map(function(e,t){return r.a.createElement("li",{className:"message-container",key:"message-".concat(t)},r.a.createElement(L,e))}))});function J(){var e=Object(b.a)(["\n  subscription NewMessage {\n    newMessage {\n      _id\n      content\n      timestamp\n      author {\n        _id\n        name\n        color\n      }\n    }\n  }\n"]);return J=function(){return e},e}function P(){var e=Object(b.a)(["\n  query AllMessages {\n    messages {\n      _id\n      content\n      author {\n        _id\n        name\n        color\n      }\n      timestamp\n    }\n  }\n"]);return P=function(){return e},e}var Q=w()(P()),W=w()(J()),G=Object(E.a)(Object(y.b)(Q),Object(E.b)(function(e){var t=e.data||{},n=t.loading,a=t.messages;return{messages:(void 0===a?[]:a).map(K).sort(H),loading:n}}),Object(y.b)(W,{name:"subscription"}),Object(E.e)(function(e){var t=e.subscription,n=(e.loading,e.messages),a=(t||{}).newMessage;return{messages:a?[].concat(Object(T.a)(n),[K(a)]).sort(H):n}}))(F),H=function(e,t){return new Date(e.date).getTime()-new Date(t.date).getTime()};function K(e){var t=function(t){return I.a.get(e,t)};return{name:t("author.name"),date:new Date(t("timestamp")),text:t("content"),avatar:r.a.createElement("div",{style:{display:"flex",borderRadius:"50%",width:50,height:50,alignItems:"center",justifyContent:"center",background:t("author.color")}})}}var V=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onSubmit=function(e){e.preventDefault(),n.input.value&&(n.props.sendMessage(n.input.value),n.input.value="")},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"footer"},r.a.createElement("form",{className:"input-container",onSubmit:this.onSubmit},r.a.createElement("input",{type:"text",placeholder:"Message",ref:function(t){return e.input=t}})))}}]),t}(r.a.Component);function X(){var e=Object(b.a)(["\n  mutation SendMessage(\n    $userId: String!\n    $content: String!\n    $timestamp: Float!\n  ) {\n    sendMessage(userId: $userId, content: $content, timestamp: $timestamp) {\n      _id\n      content\n      timestamp\n      author {\n        _id\n        name\n      }\n    }\n  }\n"]);return X=function(){return e},e}var Z=w()(X()),ee=Object(E.a)(Object(y.b)(Z,{props:function(e){var t=e.mutate;return{sendMessage:function(){var e=Object(h.a)(v.a.mark(function e(n){var a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",null);case 2:a={userId:localStorage.getItem("loggedUserId"),content:n,timestamp:(new Date).getTime()},t({variables:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}},options:{update:function(e,t){var n=t.data.sendMessage,a=Q,r=e.readQuery({query:a});r.messages.push(n),e.writeQuery({query:a,data:r})}}}))(V),te=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"chat"},r.a.createElement(Y,{roomId:this.roomId}),this.body,r.a.createElement(ee,{roomId:this.roomId}))}},{key:"body",get:function(){return r.a.createElement(q.Scrollbars,{className:"body"},r.a.createElement("div",{className:"body-content"},r.a.createElement(G,{roomId:this.roomId})))}},{key:"roomId",get:function(){return I.a.get(this.props,"match.params.roomId")}}]),t}(a.Component);function ne(e){var t=e.children;return r.a.createElement("div",{className:"screen-centered",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"}},t)}var ae=[{path:"/chat-list",exact:!0,icon:"comment",name:"Chat",render:function(){return r.a.createElement(ne,null,r.a.createElement("h1",{style:{color:"gray",fontSize:"5rem"}},"Chat list"))}},{path:"/partner",icon:"users",name:"Partner",render:function(){return r.a.createElement(ne,null,r.a.createElement("h1",{style:{color:"gray",fontSize:"5rem"}},"Partner"))}},{path:"/document",icon:"file-text",name:"Document",render:function(){return r.a.createElement(ne,null,r.a.createElement("h1",{style:{color:"gray",fontSize:"5rem"}},"Document"))}},{from:"/",redirect:"/chat-list",exact:!0}],re=n(44),ce=Object(E.a)(Object(E.e)(function(e){return{contacts:z}}));function oe(){return r.a.createElement(ne,null,r.a.createElement("h1",{style:{color:"gray",fontSize:"5rem"}},"404"))}var ie=Object(E.a)(O.a,ce)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.contacts,n=void 0===t?[]:t,a=e.match;return r.a.createElement("main",null,r.a.createElement(d.a,null,ae.map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.component,n=e.render,c=e.path,o=e.redirect,i=e.exact,s=e.from,l=arguments.length>1?arguments[1]:void 0,u={exact:i,key:"section-route-".concat(l)};return o?r.a.createElement(f.a,Object.assign({},u,{from:s,to:o})):c?r.a.createElement(p.a,Object.assign({},u,{render:n,component:t,path:Object(re.join)(a.url,c),key:"section-menu-item-".concat(l)})):null}),r.a.createElement(p.a,{path:"/chat/:roomId(".concat(n.map(function(e){return e.id}).join("|"),")"),component:te}),r.a.createElement(p.a,{component:oe})))}),se=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"home"},r.a.createElement("div",{className:"first-menu"},r.a.createElement("img",{src:"/images/365-logo.png",alt:"logo"})),r.a.createElement("div",{className:"wrap"},r.a.createElement("div",{className:"notifications"}),this.secondMenu,r.a.createElement(ie,null)))}},{key:"sectionsMenu",get:function(){return r.a.createElement("ul",{className:"sections-menu"},ae.filter(function(e){return!e.redirect}).map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.path,n=e.icon,a=e.name,c=arguments.length>1?arguments[1]:void 0;return r.a.createElement("li",{key:"section-menu-item-".concat(c)},r.a.createElement(_,{path:t,name:a,selected:!1,icon:r.a.createElement(D,{className:"icon",icon:n})}))}))}},{key:"favoriteContacts",get:function(){return r.a.createElement("div",{className:"favorite-contacts"},r.a.createElement("h5",{className:"title"},"Favorite Contacts"),r.a.createElement("ul",{className:"contacts"},z.map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.link,e.icon,e.name),n=e.color,a=e.id,c=(e.isOnline,arguments.length>1?arguments[1]:void 0);return r.a.createElement("li",{key:"contact-".concat(c)},r.a.createElement(_,{name:t,path:Object(re.join)("/chat",a),icon:r.a.createElement("div",{style:{width:30,height:30,background:n,borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"}})}))})))}},{key:"secondMenu",get:function(){return r.a.createElement("div",{className:"second-menu"},this.sectionsMenu,this.favoriteContacts)}}]),t}(a.Component),le=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app"},r.a.createElement(d.a,null,r.a.createElement(p.a,{component:M,path:"/registration",exact:!0}),r.a.createElement(p.a,{path:"/",render:function(){return localStorage.getItem("loggedUserId")?r.a.createElement(se,null):r.a.createElement(f.a,{to:"/registration"})}})))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ue=n(119),me=n(29),de=n(66),pe=n(8),fe=n(65),ge=n(60),ve=n(3),he=n(63),be="chat-365.herokuapp.com",Ee=new ge.a({uri:"ws://".concat(be,"/graphql"),options:{reconnect:!0}}),je=Object(he.a)(function(e,t){var n=t.headers,a=localStorage.getItem("loggedUserId");return console.log(a),Object(U.a)({},n,{authorization:a?"Bearer ".concat(a):""})}),Oe=new fe.a({uri:"http://".concat(be,"/graphql"),credentials:"same-origin"});Object(pe.d)(function(e){var t=e.query,n=Object(ve.k)(t),a=n.kind,r=n.operation;return"OperationDefinition"===a&&"subscription"===r},Ee);o.a.render(r.a.createElement(y.a,{client:new me.a({link:je.concat(Oe),cache:new de.a})},r.a.createElement(ue.a,null,r.a.createElement(p.a,{component:le}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},68:function(e,t,n){e.exports=n(116)},73:function(e,t,n){},77:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){},87:function(e,t,n){}},[[68,1,2]]]);
//# sourceMappingURL=main.b1117885.chunk.js.map